<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2018-12-19 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20181219" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Eiffel Intelligence Frontend &#x2013; Curl Examples to front-end</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          
                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                                                                                    <a class="brand" href="./" >

                                
                                    Eiffel Intelligence Frontend
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Home">Home</a>
</li>
                  
                      <li>      <a href="Add-Subscription.html"  title="Add Subscription">Add Subscription</a>
</li>
                  
                      <li>      <a href="GUI-Overview.html"  title="GUI overview">GUI overview</a>
</li>
                  
                      <li>      <a href="Subscription-Handling.html"  title="Subscription handling">Subscription handling</a>
</li>
                  
                      <li>      <a href="Test-Rules.html"  title="Test rules">Test rules</a>
</li>
                  
                      <li>      <a href="Front-end_with_curl.html"  title="Curl Examples">Curl Examples</a>
</li>
                          </ul>
      </li>
                  </ul>
          
          
          
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Eiffel Intelligence Frontend</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="index.html" title="Home">
        Home</a>
                    <span class="divider">-</span>
      </li>
        <li class="active ">Curl Examples to front-end</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2018-12-19</li>
              <li id="projectVersion" class="pull-right">
                    Version: 0.0.18
        </li>
            
                            </ul>
      </div>

                  
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                
      <li>
  
                          <a href="Add-Subscription.html" title="Add Subscription">
          <span class="none"></span>
        Add Subscription</a>
            </li>
                
      <li>
  
                          <a href="GUI-Overview.html" title="GUI overview">
          <span class="none"></span>
        GUI overview</a>
            </li>
                
      <li>
  
                          <a href="Subscription-Handling.html" title="Subscription handling">
          <span class="none"></span>
        Subscription handling</a>
            </li>
                
      <li>
  
                          <a href="Test-Rules.html" title="Test rules">
          <span class="none"></span>
        Test rules</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Curl Examples</a>
          </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                        
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Curl Examples to front-end</h1>
<p>The front-end is accessible not only via the web GUI.</p>
<div class="section">
<h2><a name="Introduction"></a>Introduction</h2>
<p>The front-end has a bridge functionality that is built in as a part of the front-ends web server and handles request coming from the web GUI towards any of the back-ends configured. The front-end may also be used by other tools such as CURL or any kind of program that can make HTTP(S) requests.</p>
<div class="section">
<div class="section">
<h4><a name="The_front-end_handles:"></a>The front-end handles:</h4>
<ul>

<li>POST, PUT and GET requests</li>
<li>Default back-end</li>
<li>Input back-end</li>
</ul>
<p>While the web GUI may use the back-end instances list and select different back-ends in an easy way, a user that uses the front-end without the included web GUI may need to specify a back-end URL. This may be done by adding a <tt>backendurl</tt> parameter to the request.</p>
<p>Note that for users where the front-end and back-end is running with the help of Tomcat there will be context paths used.</p></div></div>
<div class="section">
<h3><a name="Default_back-end"></a>Default back-end</h3>
<p>The front-end may have been setup with a default back-end, this means that if no back-end is specified when making a HTTP request to the front-end the default back-end will be used. If you want to see a list of back-ends and see if there is a default back-end set you may use the command:</p>
<div class="section">
<div class="section">
<div class="section">
<h6><a name="Normal_curl_command_for_get:"></a>Normal curl command for get:</h6>

<div>
<div>
<pre class="source">curl -X GET http://*front-end-url*/*contect-path-if-any*/backend
</pre></div></div>
</div>
<div class="section">
<h6><a name="Curl_command_for_get_with_host.2C_port_using_Tomcat:"></a>Curl command for get with host, port using Tomcat:</h6>

<div>
<div>
<pre class="source">curl -X GET http://localhost:8080/eifrontend/backend
</pre></div></div>
</div>
<div class="section">
<h6><a name="Curl_command_using_EI_default_settings:"></a>Curl command using EI default settings:</h6>

<div>
<div>
<pre class="source">curl -X GET http://localhost:8080/backend
</pre></div></div>

<p>The default back-end should have the key <tt>defaultBackend</tt> set to <tt>true</tt>. If the JSON list ends up empty there are no back-ends specified in the front-end. If there is no JSON object with the key set to true there is no default back-end.</p>
<p>You may see that in the list, all objects have a key <tt>active</tt> set to <tt>true or false</tt>, this key points to the back-end that acts as default, if no default back-end exist, the active should usually be the first object in the list.</p>
<p>If the back-end list lacks a default back-end one may be added by using a HTTP POST request. The injected object should be specified in JSON and look like the example below.</p>

<div>
<div>
<pre class="source">[
    {&quot;name&quot;:&quot;Any default name&quot;, &quot;host&quot;:&quot;*Your back-end url*&quot;, &quot;port&quot;:8090, &quot;contextPath&quot;:&quot;&quot;, &quot;https&quot;:false, &quot;defaultBackend&quot;:true}
]
</pre></div></div>

<p>You may add a back-end using for example CURL:</p>

<div>
<div>
<pre class="source">curl -d '{&quot;name&quot;:&quot;My Default Back-End&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:true}' \
    -H &quot;Content-Type: application/json&quot; -X POST http://localhost:8080/*front-end-context-path*/backend
</pre></div></div>

<p><b>Note:</b> <tt>name</tt> must be unique.</p>
<p>Even with different names all elements must be unique, you may not have two or more elements with the same <tt>host</tt>, <tt>port</tt>, <tt>contextPath</tt> or <tt>https</tt> value, one of these three keys must be different. Only the <tt>contextPath</tt> key may be left empty.</p></div>
<div class="section">
<h6><a name="Example_of_valid_back-end_list:"></a>Example of <b>valid</b> back-end list:</h6>

<div>
<div>
<pre class="source">[
    {&quot;name&quot;:&quot;My Back-End&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:true},
    {&quot;name&quot;:&quot;My Back-End 2&quot;,&quot;host&quot;:&quot;local-toast&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:false},
    {&quot;name&quot;:&quot;My Back-End 3&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8091,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:false},
    {&quot;name&quot;:&quot;My Back-End 4&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;/back-end&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:false},
    {&quot;name&quot;:&quot;My Back-End 5&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:true,&quot;defaultBackend&quot;:false}
]
</pre></div></div>

<p>All entries has different <tt>names</tt>. Second entry has different <tt>host</tt>, third entry has different <tt>port</tt>, third entry has different <tt>contextPath</tt>, fifth entry has <tt>https</tt> changed to true.</p></div>
<div class="section">
<h6><a name="Example_of_invalid_back-end_list:"></a>Example of <b>invalid</b> back-end list:</h6>

<div>
<div>
<pre class="source">[
    {&quot;name&quot;:&quot;My Back-End&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:true},
    {&quot;name&quot;:&quot;My Back-End&quot;,&quot;host&quot;:&quot;local-toast&quot;,&quot;port&quot;:12345,&quot;contextPath&quot;:&quot;/my-path&quot;,&quot;https&quot;:true,&quot;defaultBackend&quot;:false},
    {&quot;name&quot;:&quot;My Back-End 2&quot;,&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:8090,&quot;contextPath&quot;:&quot;&quot;,&quot;https&quot;:false,&quot;defaultBackend&quot;:false}
]
</pre></div></div>

<p>The second entry is invalid due to having the same name as the first entry. The third entry is invalid due to having the same value in all fields as the first entry.</p></div></div></div></div>
<div class="section">
<h3><a name="Specified_back-end"></a>Specified back-end</h3>
<p>As a user of the front-end you may want to specify your own back-end URL if you do not want to use the default back-end. This is possible to do by injecting the back-end URL as a query parameter. The parameters key should be <tt>backendurl</tt> then enter the full HTTP URL you wish to use.</p>
<p>An example of a way to add such parameter is below, note that the &#x201c;?&#x201d; indicates that parameters has been added to the front-end url. <tt>localhost:8080</tt> is the front-end url, and we want to access the context path /auth but on URL <tt>http://127.0.0.1:8090/</tt> that is the back-end we wish to use.</p>

<div>
<div>
<pre class="source">curl -X GET http://localhost:8080/auth?backendurl=&quot;http://127.0.0.1:8090/&quot;
</pre></div></div>

<p>Example with Tomcat:</p>

<div>
<div>
<pre class="source">curl -X GET http://localhost:8080/eifrontend/auth?backendurl=&quot;http://127.0.0.1:8090/eibackend/&quot;
</pre></div></div>

<p>This way of entering the <tt>backendurl</tt> may be the easiest way. It works with GET, POST and PUT requests. Currently entering just a back-end name is not supported.</p>
<p>Note: It is not possible to add the <tt>backendurl</tt> parameter as a JSON parameter.</p></div></div>
<div class="section">
<h2><a name="Endpoints_bridged_from_front-end_to_back-End"></a>Endpoints bridged from front-end to back-End</h2>

<table border="0" class="table table-striped">
    
<tr class="a">
        
<th>Context Path</th>
        
<th>Type</th>
        
<th>Explanation</th>
    </tr>
    
<tr class="b">
        
<td>/auth</td>
        
<td>GET</td>
        
<td>Check if LDAP security is enabled</td>
    </tr>
    
<tr class="a">
        
<td>/auth/checkStatus</td>
        
<td>GET</td>
        
<td>Used to check the back-end status.</td>
    </tr>
    
<tr class="b">
        
<td>/subscriptions</td>
        
<td>GET</td>
        
<td>Fetches all available subscriptions from the back-end</td>
    </tr>
    
<tr class="a">
        
<td>/subscriptions</td>
        
<td>POST</td>
        
<td>Request to add a new subscription included as a JSON object</td>
    </tr>
    
<tr class="b">
        
<td>/subscriptions</td>
        
<td>PUT</td>
        
<td>Request to update a given subscription object included as a JSON object</td>
    </tr>
    
<tr class="a">
        
<td>/subscriptions/*subscription name*</td>
        
<td>GET</td>
        
<td>Fetches information about a single subscription from the back-end</td>
    </tr>
    
<tr class="b">
        
<td>/subscriptions/*subscription name*</td>
        
<td>DELETE</td>
        
<td>Deletes a single instance from the back-end</td>
    </tr>
    
<tr class="a">
        
<td>/information</td>
        
<td>GET</td>
        
<td>Fetches all information from about the back-end and its components</td>
    </tr>
    
<tr class="b">
        
<td>/queryAggregatedObject</td>
        
<td>GET</td>
        
<td>Download a subscription template json file</td>
    </tr>
    
<tr class="a">
        
<td>/queryMissedNotifications</td>
        
<td>GET</td>
        
<td>Queries any missed notifications</td>
    </tr>
    
<tr class="b">
        
<td>/query</td>
        
<td>GET</td>
        
<td>Free style query; user specifies queries</td>
    </tr>
    
<tr class="a">
        
<td>/query</td>
        
<td>POST</td>
        
<td>Free style query; user specifies queries</td>
    </tr>
    
<tr class="b">
        
<td>/rules/rule-check/testRulePageEnabled</td>
        
<td>GET</td>
        
<td>TestRules status, is Test Rules functionality enabled in the back-end</td>
    </tr>
    
<tr class="a">
        
<td>/rules/rule-check/aggregation</td>
        
<td>POST</td>
        
<td>Takes rules and events from an object and returns an aggregated object</td>
    </tr>
</table>
</div>
<div class="section">
<h2><a name="Curl_Examples"></a>Curl Examples</h2>
<p>A curl call with the command: <tt>curl -X GET http://localhost:8080/auth</tt> Gives the response data <tt>{&quot;security&quot;:false}</tt>. The <tt>security</tt> parameter would be true if LDAP was enabled.</p>
<p>The <tt>/subscriptions</tt> endpoint is one that may be used the most, we may call that endpoint using three methods <tt>GET</tt>, <tt>POST</tt> and <tt>PUT</tt>.</p>
<p>A <tt>POST</tt> request with subscriptions in a file may look as the following example.</p>

<div>
<div>
<pre class="source">curl -X POST -d @file_containing_list_of_json_objects -H &quot;Content-Type: application/json&quot; \
    http://localhost:8080/subscriptions?backendurl=&quot;http://127.0.0.1:8090/&quot;
</pre></div></div>

<p>Here is an example using this endpoint and the result it gives in case we have the templated subscriptions added.</p>

<div>
<div>
<pre class="source">curl -X GET http://localhost:8080/subscriptions?backendurl=&quot;http://127.0.0.1:8090/&quot;
</pre></div></div>

<p>The back-end used is running on localhost and port 8080, we redirect the request to 127.0.0.1 and port 8090 as requested in the query parameters and the result is as follows</p>

<div>
<div>
<pre class="source">[
    {
        &quot;aggregationtype&quot;:&quot;eiffel-intelligence&quot;,
        &quot;created&quot;:1543577879242,
        &quot;notificationMeta&quot;:&quot;http://eiffel-jenkins1:8080/job/ei-artifact-triggered-job/build&quot;,
        &quot;notificationType&quot;:&quot;REST_POST&quot;,
        &quot;restPostBodyMediaType&quot;:&quot;application/x-www-form-urlencoded&quot;,
        &quot;notificationMessageKeyValues&quot;:[
            {
                &quot;formkey&quot;:&quot;json&quot;,
                &quot;formvalue&quot;:&quot;{parameter: [{ name: 'jsonparams', value : to_string(@) }]}&quot;
            }
        ],
        &quot;repeat&quot;:false,
        &quot;requirements&quot;:[
            {
                &quot;conditions&quot;:[
                    {
                        &quot;jmespath&quot;:&quot;gav.groupId=='com.othercompany.library'&quot;
                    }
                ]
            }
        ],
        &quot;subscriptionName&quot;:&quot;Subscription1&quot;,
        &quot;userName&quot;:&quot;functionalUser&quot;,
        &quot;password&quot;:&quot;&quot;,
        &quot;ldapUserName&quot;:&quot;&quot;,
        &quot;notificationMessageKeyValuesAuth&quot;:[],
        &quot;_id&quot;:{
            &quot;$oid&quot;:&quot;5c012117aeb9d61aed160a2c&quot;
        },
        &quot;authenticationType&quot;:&quot;BASIC_AUTH&quot;
    },
    {
        &quot;aggregationtype&quot;:&quot;eiffel-intelligence&quot;,
        &quot;created&quot;:1543577879265,
        &quot;notificationMeta&quot;:&quot;http://eiffel-jenkins2:8080/job/ei-artifact-triggered-job/build&quot;,
        &quot;notificationType&quot;:&quot;REST_POST&quot;,
        &quot;restPostBodyMediaType&quot;:&quot;application/x-www-form-urlencoded&quot;,
        &quot;notificationMessageKeyValues&quot;:[
            {
                &quot;formkey&quot;:&quot;json&quot;,
                &quot;formvalue&quot;:&quot;{parameter: [{ name: 'jsonparams', value : to_string(@) }]}&quot;
            }
        ],
        &quot;repeat&quot;:false,
        &quot;requirements&quot;:[
            {
                &quot;conditions&quot;:[
                    {
                        &quot;jmespath&quot;:&quot;gav.groupId=='com.othercompany.library'&quot;
                    }
                ]
            }
        ],
        &quot;subscriptionName&quot;:&quot;Subscription2&quot;,
        &quot;password&quot;:&quot;&quot;,
        &quot;ldapUserName&quot;:&quot;&quot;,
        &quot;notificationMessageKeyValuesAuth&quot;:[],
        &quot;_id&quot;:{
            &quot;$oid&quot;:&quot;5c012117aeb9d61aed160a2d&quot;
        },
        &quot;authenticationType&quot;:&quot;NO_AUTH&quot;
    },
    {
        &quot;aggregationtype&quot;:&quot;eiffel-intelligence&quot;,
        &quot;created&quot;:1543577879280,
        &quot;notificationMeta&quot;:&quot;mymail@company.com&quot;,
        &quot;notificationType&quot;:&quot;MAIL&quot;,
        &quot;restPostBodyMediaType&quot;:&quot;&quot;,
        &quot;notificationMessageKeyValues&quot;:[
            {
                &quot;formkey&quot;:&quot;&quot;,
                &quot;formvalue&quot;:&quot;{mydata: [{ fullaggregation : to_string(@) }]}&quot;
            }
        ],
        &quot;repeat&quot;:false,
        &quot;requirements&quot;:[
            {
                &quot;conditions&quot;:[
                    {
                        &quot;jmespath&quot;:&quot;gav.groupId=='com.othercompany.library'&quot;
                    }
                ]
            }
        ],
        &quot;subscriptionName&quot;:&quot;Subscription3_Mail_Notification&quot;,
        &quot;password&quot;:&quot;&quot;,
        &quot;ldapUserName&quot;:&quot;&quot;,
        &quot;notificationMessageKeyValuesAuth&quot;:[],
        &quot;_id&quot;:{
            &quot;$oid&quot;:&quot;5c012117aeb9d61aed160a2e&quot;
        },
        &quot;authenticationType&quot;:&quot;NO_AUTH&quot;
    }
]
</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          
                </div>

        
                </div>
    </footer>
        </body>
</html>
